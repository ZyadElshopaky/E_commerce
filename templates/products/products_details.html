{% extends 'base.html' %}
{% load static %}

{% block title %} 
    {{ product.title }} - Product Details
{% endblock %}

{% block contents %} 
<div class="page-content">
<div class="container py-5">
    <h1>{{ product.title }}</h1>
    <hr>
    <div class="row">
        <div class="col-md-6">
            <img src="{{ product.thumbnail }}" class="img-fluid rounded" style="max-height: 400px;" alt="{{ product.title }}">
        </div>
        <div class="col-md-6">
            <h2>Price: ${{ product.price }}</h2>
            <p>{{ product.description }}</p>
            <div class="btn-order">
                <a href="#" onclick="toggleOrder(this)">Order</a>
                <a href="/orders/">View Orders</a>
            </div>
        </div>
    </div> 

<script>
  function toggleOrder(btn) {
    const isOrdering = btn.innerText === "Order";
    btn.innerText = isOrdering ? "Cancel" : "Order";
    btn.classList.toggle("canceled");

    const product = {
      title: "{{ product.title|escapejs }}",
      thumbnail: "{{ product.thumbnail|escapejs }}",
      price: "{{ product.price|escapejs }}",
      description: "{{ product.description|escapejs }}"
    };

    let orders = JSON.parse(localStorage.getItem("orders") || "[]");

    if (isOrdering) {
      orders.push(product);
    } else {
      orders = orders.filter(p => p.title !== product.title);
    }
    localStorage.setItem("orders", JSON.stringify(orders));
  }
</script>
{% endblock %}
