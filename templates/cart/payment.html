{% extends 'base.html' %}
{% block title %} Payment {% endblock %}
{% block contents %}

<div class="stepper-container d-flex align-items-center mx-auto mt-4 mb-5" style="max-width: 600px; position: relative;">

  <div class="step d-flex align-items-center" style="position: relative;">
    <div class="rounded-circle d-flex justify-content-center align-items-center step-circle mr-2" 
         id="step1" style="width: 25px; height: 25px; background-color: #28a745; color: white; font-size: 0.8rem;">
      1
    </div>
    <div class="small nowrap ms-2">Payment Method</div>
  </div>
  
  <div class="flex-grow-1 mx-2" id="line1-2" style="border-top: 2px dashed #28a745; margin:auto 0px;"></div>

  <div class="step d-flex align-items-center" style="position: relative;">
    <div class="rounded-circle d-flex justify-content-center align-items-center step-circle mr-2" 
         id="step2" style="width: 25px; height: 25px; background-color: black; color: white; font-size: 0.8rem;">
      2
    </div>
    <div class="small nowrap ms-2">Payment Details</div>
  </div>
  

  <div class="flex-grow-1 mx-2" id="line2-3" style="border-top: 2px dashed lightgray; margin:auto 10px; "></div>
  

  <div class="step d-flex align-items-center" style="position: relative;">
    <div class="rounded-circle d-flex justify-content-center align-items-center step-circle mr-2" 
         id="step3" style="width: 25px; height: 25px; background-color: lightgray; color: white; font-size: 0.8rem;">
      3
    </div>
    <div class="small nowrap ms-2">Confirm</div>
  </div>
</div>
  <hr>
<div class="container">
  <div class="row">

    <div class="col-md-6">
      
      <h4 class="fw-bold">Items</h4>
      <div class="container p-4 m-0 shadow" style=" max-width: 500px; background-color: #fff; border: 1px solid #ccc; border-radius: 10px;">

          <div class="d-flex align-items-start mb-4 gap-3 w-100 ">
            <img src="https://th.bing.com/th/id/OIP.rVO-fc103LW5lVmD6SpvhQHaJQ?w=155&h=195&c=7&r=0&o=7&pid=1.7&rm=3" alt="صورة 1"
                 class="rounded border" style="width: 100px; height: 100px; object-fit: cover; flex-shrink: 0;">
            <div class="d-flex flex-column justify-content-between overflow-hidden flex-grow-1 mt-1" style="height: 100px; min-width: 0;">
              <div>
                <h5 class="mb-2 text-truncate fw-bold " style="font-size: 16px;">New Balance 57/40 Men's</h5>
                <p class="mb-2 text-truncate " style="font-size: 14px;">Sneaker-Mindful Grey</p>
              </div>
              <h5 class="mb-2 flex-bold fw-bold" style="font-size: 16px;">$129.00</h5>
            </div>
            <div class="d-flex align-items-center justify-content-center flex-shrink-0" style="width: 40px; height: 100px;">
              <i class="bi bi-trash-fill text-dark" style="font-size: 20px; cursor: pointer;"></i>
            </div>
          </div>

          <div class="d-flex align-items-start mb-4 gap-3 w-100">
            <img src="https://ts1.mm.bing.net/th?id=OIP.uKJa7JvWwLMNlCHOW0e3awHaJQ&pid=15.1" alt="صورة 1"
                 class="rounded border" style="width: 100px; height: 100px; object-fit: cover; flex-shrink: 0;">
            <div class="d-flex flex-column justify-content-between overflow-hidden flex-grow-1 mt-1" style="height: 100px; min-width: 0;">
              <div>
                <h5 class="mb-2 text-truncate fw-bold" style="font-size: 16px;">New Balance 57/40 Men's</h5>
                <p class="mb-2 text-truncate " style="font-size: 14px;">Sneaker-Mindful Grey</p>
              </div>
              <h5 class="mb-2 fw-bold" style="font-size: 16px;">$129.00</h5>
            </div>
            <div class="d-flex align-items-center justify-content-center flex-shrink-0" style="width: 40px; height: 100px;">
              <i class="bi bi-trash-fill text-dark" style="font-size: 20px; cursor: pointer;"></i>
            </div>
          </div>

          <div class="d-flex align-items-start mb-4 gap-3 w-100">
            <img src="https://ts4.mm.bing.net/th?id=OIP.KWtv3AUm_iab3BzFJQJfsQHaHa&pid=15.1" alt="product"
                 class="rounded border" style="width: 100px; height: 100px; object-fit: cover; flex-shrink: 0;">
            <div class="d-flex flex-column justify-content-between overflow-hidden flex-grow-1 mt-1" style="height: 100px; min-width: 0;">
              <div>
                <h5 class="mb-2 text-truncate fw-bold" style="font-size: 16px;">New Balance 57/40 Men's</h5>
                <p class="mb-2 text-truncate " style="font-size: 14px;">Sneaker-Mindful Grey</p>
              </div>
              <h5 class="mb-2 fw-bold" style="font-size: 16px;">$129.00</h5>
            </div>
            <div class="pt-1 flex-shrink-0 text-truncate mt-1" style="max-width: 120px;">
            <div class="d-flex align-items-center justify-content-center flex-shrink-0" style="width: 40px; height: 100px;">
              <i class="bi bi-trash-fill text-dark" style="font-size: 20px; cursor: pointer;"></i>
            </div>
            </div>
          </div>
      </div>
      <br><br>

      <div style="max-width: 500px; ">
        <div style="max-width: 500px;">
            <h4 class="fw-bold">Order Summary</h4>
        <div class="border rounded p-4 bg-white shadow">
          <div class="d-flex justify-content-between mb-2">
            <span>Subtotal</span>
            <span>$120.00</span>
          </div>
          <div class="d-flex justify-content-between mb-2">
            <span>Discount</span>
            <span>− $20.00</span>
          </div>
          <div class="d-flex justify-content-between mb-2">
            <span>Shipping</span>
            <span>$10.00</span>
          </div>
          <hr>
          <div class="d-flex justify-content-between fw-bold">
            <span>Total</span>
            <span>$110.00</span>
          </div>
        </div>

</div>
</div>
    </div>
    <div class="col-md-6">
      <div style="max-width: 500px;">
        <h4 class="fw-bold">Payment Method</h4>
      <div class="border rounded p-4 bg-white shadow">
        <form id="paymentForm ">
          <div class="d-grid gap-3">

            <label class="form-check border rounded p-3 pe-5 position-relative payment-option d-flex align-items-center justify-content-between" style="color: gray;">
              <input class="form-check-input position-absolute end-0 top-50 translate-middle-y me-3 "
                     type="radio" name="payment" value="visa" onchange="highlight(this); updateStepper(1);">
              <div class="d-flex align-items-center gap-2">
                <img src="https://cdn-icons-png.flaticon.com/512/349/349221.png" alt="visa" style="width: 25px;">
                <span>Visa</span>
              </div>
            </label>

            <label class="form-check border rounded p-3 pe-5 position-relative payment-option d-flex align-items-center justify-content-between" style="color: gray;">
              <input class="form-check-input position-absolute end-0 top-50 translate-middle-y me-3"
                     type="radio" name="payment" value="paypal" onchange="highlight(this); updateStepper(1);">
              <div class="d-flex align-items-center gap-2">
                <img src="https://cdn-icons-png.flaticon.com/512/196/196565.png" alt="paypal" style="width: 25px;">
                <span>PayPal</span>
              </div>
            </label>

            <label class="form-check border rounded p-3 pe-5 position-relative payment-option d-flex align-items-center justify-content-between" style="color: gray;">
              <input class="form-check-input position-absolute end-0 top-50 translate-middle-y me-3"
                     type="radio" name="payment" value="instapay" onchange="highlight(this); updateStepper(1);">
              <div class="d-flex align-items-center gap-2">
                <img src="https://th.bing.com/th/id/OIP.Zp1w2X4o3ZLT5ARy3b9HMwHaEK?w=253&h=180&c=7&r=0&o=7&pid=1.7&rm=3" alt="instapay" style="width: 25px;">
                <span>InstaPay</span>
              </div>
            </label>
          </div>
        </form>
        </div>
      </div>

      <br><br>
      <h4 class="fw-bold">Payment Details</h4>
      <div class="border rounded p-4 shadow bg-white" style="max-width: 500px;">
        <form id="paymentDetailsForm">

          <div class="mb-3">
            <label for="email" class="form-label">Email Address</label>
            <input type="email" class="form-control" id="email" placeholder="example@email.com" required>
          </div>

          <div class="mb-3">
            <label for="cardNumber" class="form-label">Card Number</label>
            <input type="text" class="form-control" id="cardNumber" placeholder="1234 5678 9012 3456" required>
          </div>

          <div class="mb-3">
            <label for="cardHolder" class="form-label">Card Holder Name</label>
            <input type="text" class="form-control" id="cardHolder" placeholder="Name on the card" required>
          </div>

          <div class="mb-3">
            <label for="address" class="form-label">Billing Address</label>
            <input type="text" class="form-control" id="address" placeholder="Street, City, ZIP" required>
          </div>

          <button type="submit" class="btn btn-dark w-100" style="background-color: black; margin-top: 15px;" onclick="updateStepper(3)">Confirm Payment</button>
        </form>
      </div>
      <br>
    </div>
  </div>
</div>
<script>
  function highlight(selectedInput) {
    document.querySelectorAll('.payment-option').forEach(label => {
      label.classList.remove('border-dark');
      label.style.color = 'gray';
    });
    const selectedLabel = selectedInput.closest('.payment-option');
    selectedLabel.classList.add('border-dark');
    selectedLabel.style.color = 'black';
  }
  
function updateStepper(step) {
  const steps = [
    { id: 'step1', line: null },
    { id: 'step2', line: 'line1-2' },
    { id: 'step3', line: 'line2-3' }
  ];

  steps.forEach((stepObj, index) => {
    const circle = document.getElementById(stepObj.id);
    const line = stepObj.line ? document.getElementById(stepObj.line) : null;

    if (index + 1 < step) {

      circle.style.backgroundColor = '#90ee90';
      if (line) line.style.borderColor = '#90ee90';
    } else if (index + 1 === step) {

      circle.style.backgroundColor = 'black';
      if (line) line.style.borderColor = '#90ee90'; 
    } else {

      circle.style.backgroundColor = 'lightgray';
      if (line) line.style.borderColor = 'lightgray';
    }
  });
}
  
  updateStepper(1);
  
  document.querySelectorAll('input[name="payment"]').forEach(input => {
    input.addEventListener('change', function() {
      updateStepper(2); 
    });
  });
  

  document.querySelectorAll('#paymentDetailsForm input').forEach(input => {
    input.addEventListener('input', function() {

      const allFilled = Array.from(document.querySelectorAll('#paymentDetailsForm input[required]'))
        .every(input => input.value.trim() !== '');
      
      if (allFilled) {
        updateStepper(3); 
      } else {
        updateStepper(2);
      }
    });
  });
  
  document.getElementById('paymentDetailsForm').addEventListener('submit', function(e) {
    e.preventDefault();
    updateStepper(3);
    alert('Payment confirmed!');
  });
</script>
{% endblock %}